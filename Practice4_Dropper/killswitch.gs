// Example gscript template
// Title: Pastebin Existence Check
// Author: Javier Rojas
// Purpose: Check if a pastebin exists and is not OFF
// Gscript version: 1.0.0
// ATT&CK: 

//priority:1
//timeout:100


function Deploy() {
    // Defino una variable con la URL del pastebin para poder probar con:
    // "https://pastebin.com/raw/QQRcaPgZ"  -> OFF
    // "https://pastebin.com/raw/mZ0sWwWn"  -> ON
    var url = "https://pastebin.com/raw/mZ0sWwWn";
    
    var headers = {"User-Agent" : "spaceman"};
    console.log("Starting GetURLAsString");
    out1 = G.requests.GetURLAsString(url, headers, true);
    
    if (out1[2] == null){
        console.log("response string: "+out1[1]);
        if (out1[1] == "OFF"){
            console.log("Killswitch = \"OFF\", exiting...")
            G.os.TerminateSelf();
            return false;
        }
        else{
            console.log("Killswitch = \"ON\", trying to disable the firewall...")
        }
    } 
    else {
        console.log("errors: "+out1[2].Errors());
    }
    
    return true;
}

